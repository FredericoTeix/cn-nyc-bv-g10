# API Keys service

## Overview

Provides authentication and authorization features through API Keys, which can be generated by an admin 
and then consulted/revoked/refreshed/consumed by the owner of the key.  
All API Keys are generated with a defined quota that limits the amount of requests that can be consumed.  
The keys also have an associated scope, which delimits the possible actions that can be performed and
which resources can be accessed by the key.  
An admin key is already created.  
```
123e4567-e89b-42d3-a456-556642440000
```

## Configuration

### Authorization

API Keys can only have one of two possible scopes: ``ADMIN`` or ``CONSUMER``.  
A file ``acl.yaml`` can be edited to configure which resources and actions can be performed by the key scopes. Each
action can consume a different amount of usages.  
The ``authorized`` list contains the endpoints that require authentication and authorization. If a request is made from any endpoint not specified here, the access is allowed.   
An example of this file is as follows:
```yaml
endpoints:            # endpoints that require a specific scope and consume usage.
  /trips:             # allowed resources are specified by its path only, without query parameters or any other URI property
    GET:              # every resource defines which operations and scopes require authorization
      CONSUMER: 3     # the number of usage consumptions is defined per scope
  /trips/{tid}:       # a path can also contain path parameters, following the template standard (surrounded by { })
    GET:
      CONSUMER: 1
    PUT:
      ADMIN: 1
  /key:
    GET:
      CONSUMER: 1
```


## Running with Docker

To run the service on a Docker environment, please execute the following from the root directory:

```bash
docker compose up
```

The service will be available at port ``8080``, while its Mongo database will be available at port ``27017``.